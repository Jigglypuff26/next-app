#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ðŸ” Running Running Running..."

# Ð¤Ð¸ÐºÑ Ð¿Ð¾ .prettierrc
echo "âš¡ðŸ”§ Prettier Fix..."
npm run format

# # 1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð»Ð¸Ð½Ñ‚Ð¸Ð½Ð³Ð° Ñ‡ÐµÑ€ÐµÐ· lint-staged
# echo "ðŸ“ Formatting and linting..."
# npx lint-staged

# # 2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¸Ð¿Ð¾Ð² TypeScript
# echo "âš¡ Type checking..."
# npm run type-check -- --noEmit

# # 3. Ð—Ð°Ð¿ÑƒÑÐº Ñ‚ÐµÑÑ‚Ð¾Ð² Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð½Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð²
# echo "ðŸ§ª Running tests..."
# npm test -- --passWithNoTests --findRelatedTests --bail

# # 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾, ÐµÑÐ»Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ð¾)
# echo "ðŸ—ï¸ Checking build..."
# npm run build -- --noEmit

# # 5. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ (Ñ€Ð°Ð· Ð² Ð´ÐµÐ½ÑŒ)
# if [ ! -f .last_audit ] || [ "$(find .last_audit -mtime +0)" ]; then
#   echo "ðŸ”’ Security audit..."
#   npm audit --audit-level moderate
#   date > .last_audit
# fi

echo "âœ… Pre-commit checks passed!"